<main class="w-full">
    <ng-container *hasPermission="{
      has: [PERMISSIONS_DATA.ALL, PERMISSIONS_DATA.READ_GLOBAL_STATEMENTS],
      mode: 'any',
      profile: MANAGEMENT_ENTITY_TYPES[1]
    }">
        <!-- MLA profile - can select company -->
        <div class="w-full mb-20" *transloco="let t">
            <div class="flex flex-col mb-6">
                <h1 class="text-2xl md:text-4xl font-bold py-4">
                    {{ t('entities.statement.annexe.title') }}
                </h1>
                <p class="text-sm md:text-base text-gray-600">
                    {{ t('entities.statement.annexe.description') }}
                </p>
            </div>

            <!-- Liste des compagnies -->
            <div class="flex flex-wrap justify-center items-center gap-4 mb-6">
                <div *ngFor="let company of companies"
                    (click)="selectCompany(company)"
                    class="flex flex-col items-center bg-white border border-gray-200 rounded-lg p-3 cursor-pointer hover:shadow transition min-w-52 max-w-52"
                    [class.ring-2]="selectedCompany?.id === company.id"
                    [class.ring-primary-600]="selectedCompany?.id === company.id">
                    <img [src]="company.logo" alt="{{ company.acronym }}" class="w-auto h-12 object-cover rounded-md mb-2" />
                    <p class="text-center text-xs font-medium">{{ company.name }}</p>
                </div>
            </div>

            <div class="bg-white p-6 rounded-lg shadow border border-gray-100">
                <h2 class="text-xl font-bold mb-4">{{ t('entities.statement.annexe.subtitle') }}</h2>

                <!-- Type d'annexe -->
                <div class="mb-6">
                    <mat-form-field appearance="outline" class="w-full">
                        <mat-label>{{ t('entities.statement.annexe.type') }}</mat-label>
                        <mat-select [(value)]="selectedType">
                            <mat-option value="ALL">{{ t('entities.statement.annexe.types.all') }}</mat-option>
                            <mat-option value="TO_PAY">{{ t('entities.statement.annexe.types.to_pay') }}</mat-option>
                            <mat-option value="TO_RECEIVE">{{ t('entities.statement.annexe.types.to_receive') }}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <!-- Période -->
                <div class="flex items-center gap-4 mb-6">
                    <div class="flex-1 flex gap-6">
                        <mat-form-field appearance="outline" class="w-full">
                            <mat-label>{{ t('entities.statement.annexe.start_date') }}</mat-label>
                            <input matInput [matDatepicker]="startPicker" [(ngModel)]="startDate">
                            <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
                            <mat-datepicker #startPicker></mat-datepicker>
                        </mat-form-field>

                        <mat-form-field appearance="outline" class="w-full">
                            <mat-label>{{ t('entities.statement.annexe.end_date') }}</mat-label>
                            <input matInput [matDatepicker]="endPicker" [(ngModel)]="endDate">
                            <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
                            <mat-datepicker #endPicker></mat-datepicker>
                        </mat-form-field>
                    </div>
                </div>

                <!-- Boutons d'action -->
                <div class="flex justify-end gap-4">
                    <button mat-raised-button color="primary" (click)="downloadPdf()">
                        <mat-icon>download</mat-icon>
                        {{ t('buttons.downloadPdf') }}
                    </button>
                </div>
            </div>
        </div>
    </ng-container>

    <ng-container *hasPermission="{
      has: [PERMISSIONS_DATA.ALL, PERMISSIONS_DATA.READ_GLOBAL_STATEMENTS],
      mode: 'any',
      profile: MANAGEMENT_ENTITY_TYPES[0]
    }">
        <!-- Company profile - cannot select company -->
        <div class="w-full mb-20" *transloco="let t">
            <div class="flex flex-col mb-6">
                <h1 class="text-2xl md:text-4xl font-bold py-4">
                    {{ t('entities.statement.annexe.title') }}
                </h1>
                <p class="text-sm md:text-base text-gray-600">
                    {{ t('entities.statement.annexe.description') }}
                </p>
            </div>

            <div class="bg-white p-6 rounded-lg shadow border border-gray-100">
                <h2 class="text-xl font-bold mb-4">{{ t('entities.statement.annexe.subtitle') }}</h2>

                <!-- Type d'annexe -->
                <div class="mb-6">
                    <mat-form-field appearance="outline" class="w-full">
                        <mat-label>{{ t('entities.statement.annexe.type') }}</mat-label>
                        <mat-select [(value)]="selectedType">
                            <mat-option value="ALL">{{ t('entities.statement.annexe.types.all') }}</mat-option>
                            <mat-option value="TO_PAY">{{ t('entities.statement.annexe.types.to_pay') }}</mat-option>
                            <mat-option value="TO_RECEIVE">{{ t('entities.statement.annexe.types.to_receive') }}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <!-- Période -->
                <div class="flex items-center gap-4 mb-6">
                    <div class="flex-1 flex gap-6">
                        <mat-form-field appearance="outline" class="w-full">
                            <mat-label>{{ t('entities.statement.annexe.start_date') }}</mat-label>
                            <input matInput [matDatepicker]="startPicker" [(ngModel)]="startDate">
                            <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
                            <mat-datepicker #startPicker></mat-datepicker>
                        </mat-form-field>

                        <mat-form-field appearance="outline" class="w-full">
                            <mat-label>{{ t('entities.statement.annexe.end_date') }}</mat-label>
                            <input matInput [matDatepicker]="endPicker" [(ngModel)]="endDate">
                            <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
                            <mat-datepicker #endPicker></mat-datepicker>
                        </mat-form-field>
                    </div>
                </div>

                <!-- Boutons d'action -->
                <div class="flex justify-end gap-4">
                    <button mat-raised-button color="primary" (click)="downloadPdf()">
                        <mat-icon>download</mat-icon>
                        {{ t('buttons.downloadPdf') }}
                    </button>
                </div>
            </div>
        </div>
    </ng-container>
</main>